# Code Highlighting

`Nextra` uses [Shiki](https://shiki.matsu.io) and
[Rehype Pretty Code](https://github.com/FormidableLabs/prism-react-renderer) to
highlight the code blocks. This section covers how you can customze it.

## Meta strings

### Highlight lines

````mdx
```jsx {1,3-5}
import 'nextra-theme-docs/style.css'

export default function Nextra({ Component, pageProps }) {
  const getLayout = Component.getLayout || (page => page)
  return getLayout(<Component {...pageProps} />)
}
```
````

```jsx {1,4-5}
import 'nextra-theme-docs/style.css'

export default function Nextra({ Component, pageProps }) {
  const getLayout = Component.getLayout || (page => page)
  return getLayout(<Component {...pageProps} />)
}
```

### Title

````mdx
```jsx filename="_app.js"
import 'nextra-theme-docs/style.css'

export default function Nextra({ Component, pageProps }) {
  const getLayout = Component.getLayout || (page => page)
  return getLayout(<Component {...pageProps} />)
}
```
````

```jsx filename="_app.js"
import 'nextra-theme-docs/style.css'

export default function Nextra({ Component, pageProps }) {
  const getLayout = Component.getLayout || (page => page)
  return getLayout(<Component {...pageProps} />)
}
```

## Supported Languages

You can find a list of supported languages
[here](https://github.com/shikijs/shiki/blob/main/docs/languages.md).

### Custom Grammar

Shiki accepts a [VSCode TextMate Grammar](https://code.visualstudio.com/api/language-extensions/syntax-highlight-guide)
for syntax highlighting with custom language grammars.

You can provide these grammars by overriding the `getHighlighter` function in
`mdxOptions.rehypePrettyCodeOptions` option in your Nextra config (`next.config.mjs`):

```js {12-17}
import {BUNDLED_LANGUAGES} from 'shiki';

nextra({
  ... // other options here
  mdxOptions: {
    rehypePrettyCodeOptions: {
      getHighlighter: options => getHighlighter({
        ...options,
        langs: [
          ...BUNDLED_LANGUAGES,
          // custom grammar options, see the Shiki documentation for how to provide these options
          {
            id: 'my-lang',
            scopeName: 'source.my-lang',
            aliases: ['mylang'], // Along with id, aliases will be included in the allowed names you can use when writing markdown.
            path: '../../public/syntax/grammar.tmLanguage.json',
          }
        ]
      })
    }
  },
})
```

## Custom Themes

Within `mdxOptions.rehypePrettyCodeOptions` you may also provide custom themes instead of 
[relying on CSS Variables](/docs/guide/syntax-highlighting):

```js {8}
import {BUNDLED_LANGUAGES} from 'shiki';

nextra({
  ... // other options here
  mdxOptions: {
    rehypePrettyCodeOptions: {
      // VSCode theme or built-in Shiki theme, see Shiki documentation for more information
      theme: JSON.parse(readFileSync('./public/syntax/arctis_light.json', 'utf-8'))
    }
  },
})
```

### Multiple Themes

Provide a record of themes to the `theme` option instead to provide multiple themes:

```js {7-10}
import {BUNDLED_LANGUAGES} from 'shiki';

nextra({
  ... // other options here
  mdxOptions: {
    rehypePrettyCodeOptions: {
      theme: {
        dark: JSON.parse(readFileSync('./public/syntax/arctis_dark.json', 'utf-8')),
        light: JSON.parse(readFileSync('./public/syntax/arctis_light.json', 'utf-8'))
      }
    }
  },
})
```

Since syntax highlighting is done at build-time, a codeblock will be rendered for every
theme and tagged with an attribute `data-theme=[key]`, e.g. `data-theme="dark"`.

You can use CSS to show and hide these codeblocks accordingly:

```css
html[class~=dark] :is(pre[data-theme='light'], code[data-theme='light']) {
  display: none;
}

html[class~=light] :is(pre[data-theme='dark'], code[data-theme='dark']) {
  display: none;
}
```
